<?xml version="1.0" encoding="UTF-8"?>
	<!--
		Example Sequoia virtual database configuration for Gemma. Please see http://sequoia.continuent.org/doc/infocenter
	-->
	<!-- @author paul -->
	<!-- @version $Id$ -->
<!DOCTYPE SEQUOIA PUBLIC "-//Continuent//DTD SEQUOIA 2.10.10//EN" "http://sequoia.continuent.org/dtds/sequoia-2.10.10.dtd">

<SEQUOIA>

	<VirtualDatabase name="gemdmini">

		<Distribution>
			<MessageTimeouts />
		</Distribution>

		<!--  configure the MySQLBackuper, which uses mysqldump. The backuperName can be anything you want. -->
		<Backup>
			<Backuper backuperName="mysqldump" className="org.continuent.sequoia.controller.backup.backupers.MySQLBackuper" />
		</Backup>

		<AuthenticationManager>
			<!--  Define the user name and password you want to use to administer the controller. -->
			<Admin>
				<User username="paul" password="xxxxx" />
			</Admin>
			<VirtualUsers>
				<!-- This is the login information for the database itself (I think) -->
				<VirtualLogin vLogin="paul" vPassword="xxxxx" />
			</VirtualUsers>
		</AuthenticationManager>

		<!--
			The database backend name must be unique in the cluster. The backend hostname is a good choice. The location of the
			database is localhost, assuming you are colocating the controller and mysqld.
		-->
		<DatabaseBackend name="ubuntu2" driver="com.mysql.jdbc.Driver" url="jdbc:mysql://localhost:3306/gemd"
			connectionTestStatement="select 1">
			<DatabaseSchema dynamicPrecision="all" />
			<ConnectionManager vLogin="paul">
				<VariablePoolConnectionManager initPoolSize="20" minPoolSize="5" maxPoolSize="0"
					idleTimeout="180" waitTimeout="0" />
			</ConnectionManager>
		</DatabaseBackend>

		<RequestManager>
			<RequestScheduler>
				<RAIDb-1Scheduler level="passThrough" />
			</RequestScheduler>


			<RequestCache>
				<MetadataCache />
				<ParsingCache />
				<ResultCache granularity="table" />
			</RequestCache>

			<LoadBalancer>
				<RAIDb-1>
					<WaitForCompletion policy="first" />
					<RAIDb-1-LeastPendingRequestsFirst />
				</RAIDb-1>
			</LoadBalancer>

			<!--
				For performance reasons you might want to put the recovery log on a different server. In this case we just use
				localhost.
			-->
			<RecoveryLog driver="com.mysql.jdbc.Driver" url="jdbc:mysql://localhost/ubuntu2recovery" login="paul"
				password="xxxxx">

				<!--
					The following statements are configured for MySQL. Other backends may need different syntax. I think it is
					important that sql statements and parameters be given large columns (TEXT, not VARCHAR(255)). Here I also set the
					sqlColumnName because the default ('sql') is a reserved word in MySQL.
				-->
				<RecoveryLogTable tableName="RECOVERY" logIdColumnType="BIGINT NOT NULL" vloginColumnType="VARCHAR(255) NOT NULL"
					sqlColumnName="sql_statement" sqlColumnType="TEXT NOT NULL" autoConnTranColumnType="CHAR(1) NOT NULL"
					sqlParamColumnType="TEXT" extraStatementDefinition=",PRIMARY KEY (log_id)" />

				<!--  These are unmodified from the examples in the Sequoia documentation -->
				<CheckpointTable tableName="CHECKPOINT" checkpointNameColumnType="VARCHAR(255) NOT NULL" />
				<BackendTable tableName="BACKEND" databaseNameColumnType="VARCHAR(255) NOT NULL" backendNameColumnType="VARCHAR(255) NOT NULL"
					checkpointNameColumnType="VARCHAR(255) NOT NULL" />
				<DumpTable tableName="DUMP" dumpNameColumnType="VARCHAR(255) NOT NULL" dumpDateColumnType="TIMESTAMP"
					dumpPathColumnType="VARCHAR(255) NOT NULL" dumpFormatColumnType="VARCHAR(255) NOT NULL" checkpointNameColumnType="VARCHAR(255) NOT NULL"
					backendNameColumnType="VARCHAR(255) NOT NULL" tablesColumnType="VARCHAR(255) NOT NULL" />

			</RecoveryLog>

		</RequestManager>

	</VirtualDatabase>

</SEQUOIA>

